{
  "conceptual": "\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"3\">By writing <a href=\"~/pages/docs/custom-code/cpp/custom-cpp-component.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"3\">custom components with C++</a> you can define typed configuration properties that show up in the editor UI. These can also use type attributes to limit the valid input range or change how the value is displayed and editable. When you use such components inside <a href=\"~/pages/docs/prefabs/prefabs-overview.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"3\">prefabs</a>, this enables you to configure an object once, but have many instances of it at runtime.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"5\">However, there are two downsides to this approach:</p>\n<ol sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"6\">\n<li sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"6\">Although you only configure a prefab once, each prefab instance still creates a copy of that data when it is spawned from the prefab template. Thus there is per-instance memory overhead for data that could be fully shared across all instances.</li>\n<li sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"7\">You may want to share the same setup across a large variety of prefab types. For example you may only have a few different creatures in your game, but lots of visual variations of them, and you want to edit their behavior properties in a single place and share it across many prefabs, rather than having to go through all of them and manually making sure that they all have the same configuration.</li>\n</ol>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"9\">The <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"9\">Custom Data</em> feature enables you to solve both of these issues.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"11\">An alternative to custom data is the <a href=\"~/pages/docs/Miscellaneous/config-file-resource.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"11\">config file resource</a>, though it has no editor integration.</p>\n<h2 id=\"creating-custom-data-types\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"13\">Creating Custom Data Types</h2>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"15\"><em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"15\">Custom data</em> types are fully defined in C++ code.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"17\">To create a new custom data type, derive from the <code sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"17\">ezCustomData</code> base class and add reflection capabilities. Then add all the properties that you need. Additionally we need to declare a dedicated <a href=\"~/pages/docs/runtime/resource-management.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"17\">resource (TODO)</a> for your data type.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"19\">The code snippet below shows what should be added to a <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"19\">header file (.h)</em>:</p>\n<!-- BEGIN-DOCS-CODE-SNIPPET: customdata-decl -->\n<pre><code class=\"lang-cpp\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"22\">class SampleCustomData2 : public ezCustomData\n{\n  EZ_ADD_DYNAMIC_REFLECTION(SampleCustomData2, ezCustomData);\n\npublic:\n  ezString m_sText;\n};\n\nEZ_DECLARE_CUSTOM_DATA_RESOURCE(SampleCustomData2);\n</code></pre>\n<!-- END-DOCS-CODE-SNIPPET -->\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"35\">Now in a corresponding <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"35\">source file (.cpp)</em> add the <a href=\"~/pages/docs/runtime/reflection-system.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"35\">reflection block</a> that enables the engine to know about the properties. Additionally we use a macro to finish the definition of our resource type.</p>\n<!-- BEGIN-DOCS-CODE-SNIPPET: customdata-impl -->\n<pre><code class=\"lang-cpp\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"38\">// clang-format off\nEZ_BEGIN_DYNAMIC_REFLECTED_TYPE(SampleCustomData, 1, ezRTTIDefaultAllocator&lt;SampleCustomData&gt;)\n{\n  EZ_BEGIN_PROPERTIES\n  {\n    EZ_MEMBER_PROPERTY(&quot;Text&quot;, m_sText),\n    EZ_MEMBER_PROPERTY(&quot;Size&quot;, m_iSize)-&gt;AddAttributes(new ezDefaultValueAttribute(42), new ezClampValueAttribute(16, 64)),\n    EZ_MEMBER_PROPERTY(&quot;Color&quot;, m_Color)-&gt;AddAttributes(new ezDefaultValueAttribute(ezColor::CornflowerBlue)),\n  }\n  EZ_END_PROPERTIES;\n}\nEZ_END_DYNAMIC_REFLECTED_TYPE;\n// clang-format on\n\nEZ_DEFINE_CUSTOM_DATA_RESOURCE(SampleCustomData);\n</code></pre>\n<!-- END-DOCS-CODE-SNIPPET -->\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"57\">This is all that needs to be done to add a new custom data type and have it show up in the editor.</p>\n<h2 id=\"using-custom-data-types-in-the-editor\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"59\">Using Custom Data Types in the Editor</h2>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"61\">In the editor create a <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"61\">Custom Data</em> <a href=\"~/pages/docs/assets/assets-overview.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"61\">asset</a> from the <a href=\"~/pages/docs/assets/asset-browser.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"61\">asset browser</a>.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"63\">Inside the asset, your new custom data type should show up in the menu:</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"65\"><img src=\"~/pages/docs/Miscellaneous/media/custom-data-asset-create.png\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"65\" alt=\"Create Custom Data\"></p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"67\">If it doesn't show up here, make sure your code is properly compiled, your plugin is <a href=\"~/pages/docs/projects/plugin-selection.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"67\">referenced</a> and <a href=\"~/pages/docs/custom-code/cpp/cpp-code-reload.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"67\">loaded</a> without errors by the editor.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"69\">When you add your custom data type, the editor displays all the properties that you configured on it:</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"71\"><img src=\"~/pages/docs/Miscellaneous/media/custom-data-asset-edit.png\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"71\" alt=\"Edit Custom Data\"></p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"73\">If a property doesn't show up, at all, make sure it is added to the reflection block in the source file. If it should show a different default value, limit the value to a certain range or show a different UI, you can add <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"73\">attributes</em> to the reflected properties. For details look at the <a href=\"~/pages/docs/runtime/reflection-system.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"73\">reflection system</a> documentation and have a look at what other components do.</p>\n<h2 id=\"using-custom-data-types-in-c-code\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"75\">Using Custom Data Types in C++ Code</h2>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"77\">To make use of your custom data type in a <a href=\"~/pages/docs/custom-code/cpp/custom-cpp-component.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"77\">C++ components</a> you first need to make it possible to reference your <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"77\">custom data asset</em> in that component, so that you can select on your component which asset it should use.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"79\">To do so, add the corresponding <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"79\">resource handle</em> as a member to your component and set up the necessary functions to modify the handle:</p>\n<!-- BEGIN-DOCS-CODE-SNIPPET: customdata-interface -->\n<pre><code class=\"lang-cpp\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"82\">SampleCustomDataResourceHandle m_hCustomData;\n\nvoid SetSampleCustomDataResource(const char* szFile)\n{\n  SampleCustomDataResourceHandle hCustomData;\n\n  if (!ezStringUtils::IsNullOrEmpty(szFile))\n  {\n    hCustomData = ezResourceManager::LoadResource&lt;SampleCustomDataResource&gt;(szFile);\n  }\n\n  m_hCustomData = hCustomData;\n}\n\nconst char* GetSampleCustomDataResource() const\n{\n  if (m_hCustomData.IsValid())\n    return m_hCustomData.GetResourceID();\n\n  return &quot;&quot;;\n}\n</code></pre>\n<!-- END-DOCS-CODE-SNIPPET -->\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"107\">Then, in the source file of your component, add the property to the component's reflection block:</p>\n<!-- BEGIN-DOCS-CODE-SNIPPET: customdata-property -->\n<pre><code class=\"lang-cpp\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"110\">EZ_ACCESSOR_PROPERTY(&quot;CustomData&quot;, GetSampleCustomDataResource, SetSampleCustomDataResource)-&gt;AddAttributes(new ezAssetBrowserAttribute(&quot;CompatibleAsset_CustomData&quot;, &quot;SampleCustomData&quot;)),\n</code></pre>\n<!-- END-DOCS-CODE-SNIPPET -->\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"115\">Make sure to add the necessary asset browser attribute, otherwise it only shows up as an ordinary string property.</p>\n<blockquote sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"117\">\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"117\"><strong sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"117\">Note:</strong></p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"119\">Using a reflected resource handle isn't strictly necessary, you can also get a custom data resource directly in code by using the <a href=\"~/pages/docs/assets/assets-overview.md#asset-guid\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"119\">asset GUID</a> to <a href=\"~/pages/docs/runtime/resource-management.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"119\">load the resource (TODO)</a> manually. It is just more convenient and enables you to select the desired resource in the editor.</p>\n</blockquote>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"121\">Now when you look at the properties of your component in the editor, it should show a field that allows you to select <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"121\">custom data assets</em>.</p>\n<blockquote sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"123\">\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"123\"><strong sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"123\">Important:</strong></p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"125\">Be aware that currently there is no filtering for the specific custom data type, so all custom data assets show up, even if they don't match the desired custom data type. If you select an incompatible one, at runtime it will log an error and give you a default constructed object.</p>\n</blockquote>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"127\">Finally, to actually access your custom data inside your game code, you have to get a <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"127\">resource lock</em> using your <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"127\">resource handle</em>:</p>\n<!-- BEGIN-DOCS-CODE-SNIPPET: customdata-access -->\n<pre><code class=\"lang-cpp\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"130\">ezResourceLock&lt;SampleCustomDataResource&gt; pCustomDataResource(m_hCustomData, ezResourceAcquireMode::AllowLoadingFallback_NeverFail);\n\nif (pCustomDataResource.GetAcquireResult() == ezResourceAcquireResult::Final)\n{\n  const SampleCustomData* pCustomData = pCustomDataResource-&gt;GetData();\n\n  ezDebugRenderer::Draw3DText(GetWorld(), ezFmt(pCustomData-&gt;m_sText), GetOwner()-&gt;GetGlobalPosition(), pCustomData-&gt;m_Color, pCustomData-&gt;m_iSize);\n}\n</code></pre>\n<!-- END-DOCS-CODE-SNIPPET -->\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"142\">As you can see in the snippet above, once you have a <em sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"142\">resource lock</em> you can access your custom data type like a regular C++ class. Make sure not to hold direct pointers to the data struct, but always go through the resource lock and keep the resource handle around for the entire duration that you potentially want to access the resource, as it determines the resource's lifetime.</p>\n<p sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"144\">For more details about how to use resources, see the <a href=\"~/pages/docs/runtime/resource-management.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"144\">resource management (TODO)</a> chapter.</p>\n<h2 id=\"see-also\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"146\">See Also</h2>\n<ul sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"148\">\n<li sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"148\"><a href=\"~/pages/docs/Miscellaneous/config-file-resource.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"148\">Config File Resource</a></li>\n<li sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"149\"><a href=\"~/pages/samples/sample-game-plugin.md\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"149\">Sample Game Plugin</a></li>\n</ul>\n",
  "type": "Conceptual",
  "source": {
    "remote": {
      "path": "pages/docs/Miscellaneous/custom-data.md",
      "branch": "main",
      "repo": "https://github.com/ezEngine/docs-src"
    },
    "startLine": 0.0,
    "endLine": 0.0
  },
  "path": "pages/docs/Miscellaneous/custom-data.md",
  "documentation": {
    "remote": {
      "path": "pages/docs/Miscellaneous/custom-data.md",
      "branch": "main",
      "repo": "https://github.com/ezEngine/docs-src"
    },
    "startLine": 0.0,
    "endLine": 0.0
  },
  "_appFaviconPath": "assets/images/favicon.svg",
  "_appFooter": "Hello",
  "_appLogoPath": "assets/images/EZ-text.svg",
  "_appName": "ezEngine",
  "_appTitle": "ezEngine",
  "_enableGoogleAnalytics": true,
  "_enableNewTab": true,
  "_enableSearch": true,
  "_gitContribute": {
    "repo": "https://github.com/ezEngine/docs-src",
    "branch": "main"
  },
  "_systemKeys": [
    "conceptual",
    "type",
    "source",
    "path",
    "documentation",
    "title",
    "rawTitle",
    "wordCount"
  ],
  "rawTitle": "<h1 id=\"custom-data\" sourcefile=\"pages/docs/Miscellaneous/custom-data.md\" sourcestartlinenumber=\"1\">Custom Data</h1>",
  "title": "Custom Data",
  "wordCount": 915.0,
  "_key": "pages/docs/Miscellaneous/custom-data.md",
  "_navKey": "~/toc.yml",
  "_navPath": "toc.html",
  "_navRel": "../../../toc.html",
  "_path": "pages/docs/Miscellaneous/custom-data.html",
  "_rel": "../../../",
  "_tocKey": "~/pages/docs/toc.md",
  "_tocPath": "pages/docs/toc.html",
  "_tocRel": "../toc.html",
  "__global": {
    "namespacesInSubtitle": "Namespaces",
    "classesInSubtitle": "Classes",
    "structsInSubtitle": "Structs",
    "interfacesInSubtitle": "Interfaces",
    "enumsInSubtitle": "Enums",
    "delegatesInSubtitle": "Delegates",
    "constructorsInSubtitle": "Constructors",
    "fieldsInSubtitle": "Fields",
    "propertiesInSubtitle": "Properties",
    "methodsInSubtitle": "Methods",
    "eventsInSubtitle": "Events",
    "operatorsInSubtitle": "Operators",
    "eiisInSubtitle": "Explicit Interface Implementations",
    "functionsInSubtitle": "Functions",
    "variablesInSubtitle": "Variables",
    "typeAliasesInSubtitle": "Type Aliases",
    "membersInSubtitle": "Members",
    "improveThisDoc": "Edit this page",
    "viewSource": "View Source",
    "inheritance": "Inheritance",
    "derived": "Derived",
    "inheritedMembers": "Inherited Members",
    "package": "Package",
    "namespace": "Namespace",
    "assembly": "Assembly",
    "syntax": "Syntax",
    "overrides": "Overrides",
    "implements": "Implements",
    "remarks": "Remarks",
    "examples": "Examples",
    "seealso": "See Also",
    "declaration": "Declaration",
    "parameters": "Parameters",
    "typeParameters": "Type Parameters",
    "type": "Type",
    "name": "Name",
    "description": "Description",
    "returns": "Returns",
    "fieldValue": "Field Value",
    "propertyValue": "Property Value",
    "eventType": "Event Type",
    "variableValue": "Variable Value",
    "typeAliasType": "Type Alias Type",
    "exceptions": "Exceptions",
    "condition": "Condition",
    "extensionMethods": "Extension Methods",
    "note": "Note",
    "warning": "Warning",
    "tip": "Tip",
    "important": "Important",
    "caution": "Caution",
    "tocToggleButton": "Show / Hide Table of Contents",
    "tocFilter": "Filter by title",
    "search": "Search",
    "searchResults": "Search Results for",
    "searchResultsCount": "{count} results for \"{query}\"",
    "searchNoResults": "No results for \"{query}\"",
    "pageFirst": "First",
    "pagePrev": "Previous",
    "pageNext": "Next",
    "pageLast": "Last",
    "inThisArticle": "In this article",
    "nextArticle": "Next",
    "prevArticle": "Previous",
    "backToTop": "Back to top",
    "themeLight": "Light",
    "themeDark": "Dark",
    "themeAuto": "Auto",
    "changeTheme": "Change theme",
    "copy": "Copy",
    "downloadPdf": "Download PDF",
    "_shared": {}
  },
  "_disableToc": false,
  "docurl": "https://github.com/ezEngine/docs-src/blob/main/pages/docs/Miscellaneous/custom-data.md/#L1"
}