<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Visual Script Class Asset | ezEngine </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Visual Script Class Asset | ezEngine ">
      
      <link rel="icon" href="../../../../assets/images/favicon.svg">
      <link rel="stylesheet" href="../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ezEngine/docs-src/blob/main/pages/docs/custom-code/visual-script/visual-script-class-asset.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../index.html">
            <!--
			<img id="logo" class="svg" src="../../../../assets/images/EZ-text.svg" alt="ezEngine" >
            ezEngine
			-->
			<img id="logo" src="../../../../assets/images/EZ-text.svg" style="width: 100px; height: 50px;" alt="ezEngine">
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="visual-script-class-asset">Visual Script Class Asset</h1>

<p>The <em>Visual Script Class</em> asset enables you to define custom logic for <a href="../../runtime/world/components.html">components</a> and <a href="../game-logic/state-machine-asset.html">state machines</a> using a visual programming language. Its intended use is to bridge the gap between what other components provide. For example a <a href="../../physics/jolt/actors/jolt-trigger-component.html">trigger component</a> provides an event when something enters an area, and a <a href="../../gameplay/spawn-component.html">spawn component</a> can spawn a <a href="../../prefabs/prefabs-overview.html">prefab</a>, however, to have a creature spawn in a room when the player enters it, you need something that connects the two. Visual scripts are a great way to accomplish this.</p>
<h2 id="visual-script-editor">Visual Script Editor</h2>
<p><img src="media/vs-layout.png" alt="Visual Script Editor"></p>
<p>The image above shows the visual script editor layout. On the left is the graph editor where you can add and connect <em>nodes</em>. Right-click and drag to pan the view. Use the mouse wheel to zoom.</p>
<p>On the right is the <em>property panel</em> which shows the properties of the selected node. Node connections cannot be selected and don't have properties.</p>
<p>When nothing is selected, as in this case, the general script properties are displayed.</p>
<h2 id="script-base-class">Script Base Class</h2>
<p>Deselect all nodes to see the script properties. The <code>Base Class</code> property defines in which scenario the script may be used.</p>
<h3 id="base-class-component">Base Class: Component</h3>
<p>When <em>Component</em> is selected as the base class, the script acts like a component. Component specific functions like <code>Component::GetScriptOwner()</code> are only available with this base class.</p>
<p>These scripts are used in conjunction with the <a href="script-component.html">script component</a> to execute them.</p>
<h3 id="base-class-state-machine-state">Base Class: State Machine State</h3>
<p>When <em>StateMachineState</em> is selected as the base class, the script acts like a custom state for a <a href="../game-logic/state-machine-asset.html">state machine</a>. In this case, different functions are available, such as <code>StateMachineState::GetScriptOwner()</code>.</p>
<p>These scripts are used in state machines through the <a href="../game-logic/state-machine-asset.html#script-state">script state</a>.</p>
<h2 id="visual-script-variables">Visual Script Variables</h2>
<p>Through the general script properties you can add <em>variables</em> to your script. These may just be internal variables to keep track of state, but when the <code>Expose</code> flag is enabled, they become <a href="../../scenes/exposed-parameters.html">exposed parameters</a>. These variables will show up where the script is used (for example on <a href="script-component.html">script components</a>) and allow you to pass in different starting values.</p>
<h2 id="editing-visual-scripts">Editing Visual Scripts</h2>
<p>To build a visual script, right-click into the graph editor to open the context menu:</p>
<p><img src="media/vs-context.png" alt="Context Menu"></p>
<p>The menu shows all the available <em>nodes</em> that can be added. Type into the menu's header to search for specific items.</p>
<p>Nodes have <em>pins</em> on the left or right side with which they can be connected. The flow of execution and data goes from left to right. You connect pins via drag and drop. Every pin has a color-coded type. Not all pin types are compatible. Once you start dragging from a pin, all incompatible pins are greyed out and connections snap towards compatible pins. Depending on the target pin type, a data conversion may happen. For example, if a <em>number pin</em> is connected with a <em>string pin</em>, the number will be converted to text.</p>
<h3 id="nodes">Nodes</h3>
<p>When you select a node, you will see its <em>properties</em> on the right.</p>
<p>When a node has <em>input pins</em> (pins on the left), it often also has properties for those pins. This is used for setting an input to a <em>constant value</em>, rather than passing it in through the pin. So when an input pin is unconnected, the script will use the value from the property grid.</p>
<p>Some nodes have additional configuration properties, that cannot be passed in through a pin, for example <code>GameObject::TryGetComponentOfBaseType()</code> where you have to select the desired base type.</p>
<h3 id="execution-pins">Execution Pins</h3>
<p>Execution pins are the grey, arrow-shaped pins at the top of nodes. Not all nodes have them. These pins define the order in which nodes are executed. Only very few nodes have only an outgoing execution pin. These are <em>entry points</em> for the script, meaning they are where script execution starts. For instance, in the image at the top, the <em>Update</em> node is an entry point. Whenever the script gets <em>updated</em> (usually once every frame), this node gets executed. After that, the node that is connected to it through an <em>execution pin</em> gets executed. This continue until the last node in a chain was executed.</p>
<p>Some nodes have multiple outgoing execution pins, such as the <code>Switch</code> nodes. These nodes are used to conditionally execute one or another <em>code path</em>.</p>
<p>When a node has an incoming execution pin, it must be connected to something, otherwise the node can never be executed. However, nodes that do not have execution pins, at all, are executed <em>on demand</em> whenever their output is needed by another node that is being executed.</p>
<h3 id="data-pins">Data Pins</h3>
<p>All the round pins are <em>data pins</em> meaning they represent some kind of data. Many different types of data are supported. Numbers are generally convertible into other number types, and nearly everything can be converted to the string type, but most other types mostly exist to be passed unmodified from one node to another.</p>
<h2 id="coroutines">Coroutines</h2>
<p>The flow of execution starts at an <em>entry point</em> node and follows the execution pins to the right until the last node is reached. Usually this will happen within on script update and thus all nodes along the path are executed within the same game tick.</p>
<p><em>Coroutines</em> allow you to pause execution at any point in the graph, and have the script continue there at a later time. Consequently, a script may have multiple <em>threads of execution</em>, meaning that there might be several execution paths active over a longer period of time.</p>
<p>Have a look at this script:</p>
<p><img src="media/vs-state.png" alt="Coroutines"></p>
<p>There are two <em>entry points</em>, the <code>OnEnter</code> node and the <code>Update</code> node. <code>OnEnter</code> is only executed once when the state machine state got activated. However, <code>Update</code> is executed once every game tick (every frame).</p>
<p>The <code>OnEnter</code> code path uses the <code>Wait</code> function. This turns the entire execution path into a <em>coroutine</em>. What this means is that when <code>Wait</code> is encountered, this execution path pauses for a second. After the wait is over, it continues from that point until it runs into the next <code>Wait</code> call.</p>
<blockquote>
<p><strong>Tip:</strong></p>
<p>When an execution path uses coroutine functionality and thus may execute over a longer duration, the <em>entry point node</em> of that path shows an extra icon of two crossing arrows in its top left corner. See the <code>OnEnter</code> node in the image above and compare it to the <code>Update</code> node, which is not a coroutine.</p>
</blockquote>
<p>In the mean time, the <code>Update</code> node is executed every frame. Thus when it runs, you already have two <em>threads of execution</em>, the one starting in the <code>Update</code> node which finishes right away, and the one that started from the <code>OnEnter</code> which is dormant for a time, but continues after a while.</p>
<p>Coroutines are a powerful and very convenient feature, as they make it possible to write code in a very linear fashion, even though there are complex, temporal dependencies.</p>
<p>A common use case for coroutines is to sequence AI tasks or quest objectives. For example one may instruct an NPC to walk to a position and then sit down. The command to walk somewhere is given through a node. But then an AI system has to calculate a path and steer the creature around obstacles to make it reach that point. None of this is part of the visual script, instead the <em>walkTo</em> node would be a coroutine node that pauses the script until the task is fulfilled or failed. On success the script would then run the next node to play the sit down animation. So the script is very simple, even though walking to a spot is a very complex operation.</p>
<h3 id="coroutine-modes">Coroutine Modes</h3>
<p>When an <em>entry point</em> node gets executed that already spawn a thread of execution before, and that thread is not yet finished, there are three different ways to continue.</p>
<ol>
<li><p><em>Stop Other</em>: In this case, the existing coroutine gets canceled without notice. Use this mode when you always only want to react to the latest update. For example, you may have a coroutine that moves a creature to a picked location when the player clicks somewhere. Once the player clicks somewhere else, you would want the creature <em>only</em> to walk to the new target, and want to cancel the previous coroutine.</p>
</li>
<li><p><em>Don't Create New</em>: In this mode you let an existing coroutine fully finish before starting a new one. For example a door would react to a button press by fully opening or closing and only react to another button press when the first action is over.</p>
</li>
<li><p><em>Allow Overlap</em>: In this mode every single event would spawn a new coroutine, which all execute in parallel. For example a timer may fire once a second and every time you want to react to this by doing something complex, then you would use this mode to react to all events equally.</p>
</li>
</ol>
<p>The coroutine mode is selectable on every <em>entry point</em> node.</p>
<h3 id="advanced-coroutine-features">Advanced Coroutine Features</h3>
<p>Every entry point provides a coroutine ID. This can be used to cancel a specific coroutine if needed. Similarly, there are functions to stop all coroutines or start separate ones. You can also use the <code>Yield</code> node to interrupt a script at a specific point and have it continue in the next frame.</p>
<h2 id="loops">Loops</h2>
<p>You can execute loops to iterate over data or repeat certain actions. Several different <em>loop nodes</em> are available. They all operate in the same way, that they have two outgoing <em>execution pins</em>. One execution pin is for the <em>loop body</em>. This execution path will be executed repeatedly until the loop is finished. Finally, the <em>completed</em> execution pin is executed to continue with the code that comes after the loop.</p>
<p>For example, the following script loops from 0 to 8 (inclusive) and for each iteration it adds the loop index to the counter variable. After the loop has been completed the execution flow continues at the <em>completed</em> pin, so a <code>SetColor</code> message is sent to the owner game object. Also note that the loop body contains a <code>Yield</code> statement so the loop is paused after every iteration and resumed the next frame (see the <em>coroutines</em> section above).</p>
<p><img src="media/vs-loop.png" alt="Loop"></p>
<h2 id="node-types">Node Types</h2>
<p>The following broad categories of nodes exist:</p>
<h3 id="event-handlers">Event Handlers</h3>
<p>Event handlers are nodes that get executed when a certain <a href="../../runtime/world/world-messaging.html">message</a> is sent to any of the objects that this script is responsible for. All event handlers are <em>entry points</em> into the script and most scripts will only execute as a reaction to an event.</p>
<h3 id="blackboards">Blackboards</h3>
<p>All the nodes for working with <a href="../../Miscellaneous/blackboards.html">blackboards</a>.</p>
<h3 id="clock">Clock</h3>
<p>There are two clocks, the <em>global clock</em> and the <em>world clock</em>. The global one always advances in real-time and should be used for animating things that are independent of the game speed. The world clock should be used for all game-play functionality that should slow down or speed up according to the game's speed, so that they work correctly in slow-motion.</p>
<h3 id="component">Component</h3>
<p>Here you find all functionality shared by all <a href="../../runtime/world/components.html">components</a> such as:</p>
<ul>
<li><code>GetOwner</code>: Returns the components owner game object.</li>
<li><code>GetWorld</code>: Returns the world that the component belongs to.</li>
</ul>
<p>Additionally, all component specific functionality can be found in the sub-menus.</p>
<h3 id="coroutine">Coroutine</h3>
<p>Here you find all functionality to work with coroutines, see <a href="#coroutines">the coroutines section</a> above.</p>
<h3 id="debug">Debug</h3>
<p>These nodes are for <a href="../../debugging/debug-rendering.html">debug rendering</a>.</p>
<h3 id="enums">Enums</h3>
<p>These nodes are for working with enum values. There are two node types for each enum. The <em>value</em> nodes just return a fixed value and can be used to pass along. The <em>switch</em> nodes are used for reading an enum value and then executing a code path depending on the value.</p>
<h3 id="game-object">Game Object</h3>
<p><a href="../../runtime/world/game-objects.html">Game objects</a> nodes are for reading and writing object transforms, finding and accessing child objects and components.</p>
<h3 id="log">Log</h3>
<p>Nodes for <a href="../../debugging/logging.html">logging</a>.</p>
<h3 id="logic">Logic</h3>
<p>This group contains mathematical logic operators as well as conditions and loops. Very important nodes are:</p>
<ul>
<li><code>Branch</code>: An <code>if</code> condition node with two possible outcomes.</li>
<li><code>Switch</code>: Several variants to map one value to multiple possible outcomes.</li>
<li><code>Compare</code>: Checks whether two values are equal, with a boolean result.</li>
<li><code>Is Valid</code>: Checks whether the incoming value, such as a game object or component, can still be used.</li>
</ul>
<h3 id="math">Math</h3>
<p>All sorts of mathematical operations for working with number types.</p>
<h3 id="messages">Messages</h3>
<p>While event handlers react to messages, the script can also <em>send messages</em> to other objects. Messages can be sent directly to a component, or to a game object, in which case they may be broadcast to all components on that object, or even to the whole sub-tree of objects and components. If the <code>Send Mode</code> is set to <em>Event</em>, however, they are delivered not downwards in the hierarchy, but <em>upwards</em> along the parent chain of the target object, to the closest component that handles this type of message. See <a href="../../runtime/world/world-messaging.html#event-messages">this chapter</a> for details.</p>
<h3 id="property">Property</h3>
<p>For reading and writing component properties.</p>
<h3 id="statemachineinstance-and-statemachinestate">StateMachineInstance and StateMachineState</h3>
<p>For interacting with <a href="../game-logic/state-machine-asset.html">state machines</a>. This is mainly necessary when the script itself is used as a <em>StateMachineState</em>. Be aware that the <em>state machine instance</em> in which the script is run, is passed into the script through the <code>OnEnter</code>, <code>OnExit</code> and <code>Update</code> nodes.</p>
<h3 id="string">String</h3>
<p>For working with strings, e.g. to format a string by combining variable values.</p>
<h3 id="time">Time</h3>
<p>For working with the <em>time</em> data type.</p>
<h3 id="type-conversion">Type Conversion</h3>
<p>These nodes are for converting variables from one type to another. Especially important is the <code>ConvertTo</code> node, which is used for converting a <em>Variant</em> to an expected type. A <em>Variant</em> is a variable that can contain data of many different types. When a node returns a variant, you usually expect that it contains a certain type and using the <code>ConvertTo</code> node, you can get to it.</p>
<h3 id="variable-nodes">Variable Nodes</h3>
<p>These nodes operate on <a href="#visual-script-variables">visual script variables</a>. The variables have to be declared on the script first. Use these to keep track of state within the script and also to read state that was passed in through <a href="../../scenes/exposed-parameters.html">exposed parameters</a>.</p>
<h3 id="world">World</h3>
<p>These nodes provide access to the <a href="../../runtime/world/worlds.html">world</a>, which is used for managing objects.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="visual-script-overview.html">Custom Code with Visual Scripts</a></li>
<li><a href="script-component.html">Script Component</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ezEngine/docs-src/blob/main/pages/docs/custom-code/visual-script/visual-script-class-asset.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
		<!--
          Hello
		-->
		  <span class="pull-right">
			<a href="#top">Back to top</a>
		  </span>
		  <span class="footer-logo">
			<a id="logo_ez" href="https://ezEngine.net"></a>
		  </span>
		  <span class="footer-logo">
			<a id="logo_github" href="https://github.com/ezEngine/ezEngine" target="_blank"></a>
		  </span>
		  <span class="footer-logo">
			<a id="logo_twitter" href="https://twitter.com/ezengineproject" target="_blank"></a>
		  </span>
		  <span class="footer-logo">
			<a id="logo_discord" href="https://discord.gg/rfJewc5khZ" target="_blank"></a>
		  </span>
		  <span class="footer-logo">
			<a id="logo_youtube" href="https://www.youtube.com/@ezEngine" target="_blank"></a>
		  </span>
        </div>
      </div>
    </footer>
  </body>
</html>