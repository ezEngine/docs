{
  "conceptual": "\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"3\"><em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"3\">World modules</em> are systems that are used to update certain aspects of a world. There can be only one instance of each world module for each <a href=\"~/pages/docs/runtime/world/worlds.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"3\">world</a>.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"5\">A good example for a world module is the <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"5\">ezJoltWorldModule</code>. This module is responsible for updating the physics world every frame. To do so, it hooks into two <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"5\">update phases</em> of the world, once early in the frame, where it kicks off the physics simulation in a parallel task, and once late in the frame, where it fetches the results of the simulation and applies them to the world.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"7\">Components represent individual pieces in the world. World modules represent large systems that provide the foundation for the components to work. World modules are frequently needed when integrating third party systems that require per frame updates to function.</p>\n<h2 id=\"creating-and-instantiating-world-modules\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"9\">Creating and Instantiating World Modules</h2>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"11\">You create a new world module class by deriving from <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"11\">ezWorldModule</code>.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"13\">You never instantiate world modules yourself. Instead, call <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"13\">ezWorld::GetOrCreateModule()</code>. This will allocate the desired world module if necessary.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"15\">Consequently, if no code path ever calls <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"15\">ezWorld::GetOrCreateModule()</code>, the respective world module will never be instantiated. Therefore, the lifetime and existence of a world module is often coupled to some component. Once a component is added to a world, its respective <a href=\"~/pages/docs/runtime/world/component-managers.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"15\">component manager</a> (which also is a world module) is automatically instantiated. If those components request access to another world module, that will be instantiated, as well.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"17\">Only few systems require a world module, without having some component type that would request its instantiation. For example, there is no need to instantiate a physics world module, if the scene doesn't contain any physics component.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"19\">If you do need a system that is always running, consider putting it into a <a href=\"~/pages/docs/runtime/application/game-state.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"19\">game state</a>. And if you determine it really does need to be a world module, a custom game state may be the right place to do the initial call to <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"19\">ezWorld::GetOrCreateModule()</code> to instantiate the system.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"21\">The more common approach, though, is to have a custom component type, which ensures to set up a world module. You would then put a single component of this type into each world. This also allows you to have properties on the component, with which you can configure the world module.</p>\n<h3 id=\"example-wind-world-module\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"23\">Example: Wind World Module</h3>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"25\">Code can query for the <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"25\">ezWindWorldModuleInterface</code> using <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"25\">ezWorld::GetWorldModule&lt;ezWindWorldModuleInterface&gt;()</code>. If a world module that implements this interface exists, the function will return a valid pointer. Things like <a href=\"~/pages/docs/effects/particle-effects/particle-effects-overview.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"25\">particle effects</a> can then ask the system for a wind value at their location, to apply wind to particles.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"27\"><a href=\"~/pages/docs/effects/wind/wind.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"27\">Wind</a> can be implemented in different ways. From full 3D fluid simulations with turbulence, over simpler models, down to entirely basic models with just a randomly changing wind vector. What implementation you want may depend on your scene. Therefore, you choose the wind module by adding a corresponding component to the level. Out of the box you can have either no wind, or very simple wind. By adding an <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"27\">ezSimpleWindComponent</code> to a scene, that component will make sure a wind module of type <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"27\">ezSimpleWindWorldModule</code> is instantiated. Through the component's properties you can configure how the wind behaves.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"29\">If you want different wind behavior, you can add your own implementation of <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"29\">ezWindWorldModuleInterface</code> through a <a href=\"~/pages/docs/custom-code/cpp/engine-plugins.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"29\">plugin</a>. You would then add your own wind component, which instantiates and configures your custom wind module.</p>\n<h2 id=\"update-functions\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"31\">Update Functions</h2>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"33\">The main feature of world modules is that they can hook into the world update and execute code at specific points. To do so, they need to register update functions using <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"33\">ezWorldModule::RegisterUpdateFunction()</code>. This should be done during <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"33\">ezWorldModule::Initialize()</code>.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"35\">To register an update function, you need to fill out an <code sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"35\">UpdateFunctionDesc</code>. This takes a delegate to the actual function that should be called, and requires you to give a unique name to that function. This way, other world modules can refer to your update function by name. This is useful, when you have dependencies between world modules. Say you need to run one part of the physics update, then a specific animation update and finally another part of the physics update. You can do so, by registering three update functions and set up dependencies. The world will then execute the update functions in the required order.</p>\n<h3 id=\"update-phases\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"37\">Update Phases</h3>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"39\">An important aspect of the update functions is in which <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"39\">update phase</em> of the world they are executed. These are the steps in which the world is updated:</p>\n<ol sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"41\">\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"41\"><strong sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"41\">Pre-async phase:</strong> The corresponding update functions are called synchronously in the order of their dependencies.</li>\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"42\"><strong sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"42\">Async phase:</strong> The update functions are called in batches, asynchronously on multiple threads.\n<ul sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"43\">\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"43\">There is no guarantee in which order they are called.</li>\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"44\">It is not allowed to access any data other than the components' own data during this phase.</li>\n</ul>\n</li>\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"45\"><strong sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"45\">Post-async phase:</strong> Another synchronous phase like the pre-async phase.</li>\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"46\"><strong sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"46\">Object deletion:</strong> Dead objects and components are removed.</li>\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"47\"><strong sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"47\">Transform update:</strong> The global transformation of all dynamic objects is updated.</li>\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"48\"><strong sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"48\">Post-transform phase:</strong> Another synchronous phase like the pre-async phase, after the global transformation has been updated.</li>\n</ol>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"50\">The choice in which phase to run an update function affects performance, how you can access other components, and how recent some data is that you read.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"52\">Many things must be updated in a single-threaded way. These would typically be done in the <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"52\">pre-async</em> phase. Since everything runs single-threaded here, you can access other components, both to read and to modify them.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"54\">If you have something that operates solely on the data of a single component and would be safe to be executed for multiple components at the same time, you should put this into the <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"54\">async</em> phase. Your update function will automatically be distributed across multiple threads to speed things up.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"56\">If you do have an async update, you may need to finalize or clean up some data afterwards, but in a single threaded way. Use the <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"56\">post async</em> phase for that.</p>\n<p sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"58\">In all of these phases you can modify the owner game object's <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"58\">local transform</em>, but when you read the <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"58\">global transform</em> you will get the value from the previous frame. For most use cases this is sufficient, but in a few cases you must have the absolutely latest global transform, to prevent things from lagging a frame behind. For those cases you use the <em sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"58\">post transform</em> phase. Here you can read the latest global transform value that will be used by the renderer. You can still modify the local transform here, but it won't have an effect until the next frame.</p>\n<h2 id=\"see-also\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"60\">See Also</h2>\n<ul sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"62\">\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"62\"><a href=\"~/pages/docs/runtime/world/component-managers.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"62\">Component Managers</a></li>\n<li sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"63\"><a href=\"~/pages/docs/runtime/world/world-overview.md\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"63\">The World / Scenegraph System</a></li>\n</ul>\n",
  "type": "Conceptual",
  "source": {
    "remote": {
      "path": "pages/docs/runtime/world/world-modules.md",
      "branch": "main",
      "repo": "https://github.com/ezEngine/docs-src"
    },
    "startLine": 0,
    "endLine": 0
  },
  "path": "pages/docs/runtime/world/world-modules.md",
  "documentation": {
    "remote": {
      "path": "pages/docs/runtime/world/world-modules.md",
      "branch": "main",
      "repo": "https://github.com/ezEngine/docs-src"
    },
    "startLine": 0,
    "endLine": 0
  },
  "_appFaviconPath": "assets/images/favicon.svg",
  "_appFooter": "Hello",
  "_appLogoPath": "assets/images/EZ-text.svg",
  "_appName": "ezEngine",
  "_appTitle": "ezEngine",
  "_enableGoogleAnalytics": true,
  "_enableNewTab": true,
  "_enableSearch": true,
  "_gitContribute": {
    "repo": "https://github.com/ezEngine/docs-src",
    "branch": "main"
  },
  "_systemKeys": [
    "conceptual",
    "type",
    "source",
    "path",
    "documentation",
    "title",
    "rawTitle",
    "wordCount"
  ],
  "rawTitle": "<h1 id=\"world-modules\" sourcefile=\"pages/docs/runtime/world/world-modules.md\" sourcestartlinenumber=\"1\">World Modules</h1>",
  "title": "World Modules",
  "wordCount": 1081,
  "_key": "pages/docs/runtime/world/world-modules.md",
  "_navKey": "~/toc.yml",
  "_navPath": "toc.html",
  "_navRel": "../../../../toc.html",
  "_path": "pages/docs/runtime/world/world-modules.html",
  "_rel": "../../../../",
  "_tocKey": "~/pages/docs/toc.md",
  "_tocPath": "pages/docs/toc.html",
  "_tocRel": "../../toc.html",
  "__global": {
    "namespacesInSubtitle": "Namespaces",
    "classesInSubtitle": "Classes",
    "structsInSubtitle": "Structs",
    "interfacesInSubtitle": "Interfaces",
    "enumsInSubtitle": "Enums",
    "delegatesInSubtitle": "Delegates",
    "constructorsInSubtitle": "Constructors",
    "fieldsInSubtitle": "Fields",
    "propertiesInSubtitle": "Properties",
    "methodsInSubtitle": "Methods",
    "eventsInSubtitle": "Events",
    "operatorsInSubtitle": "Operators",
    "eiisInSubtitle": "Explicit Interface Implementations",
    "functionsInSubtitle": "Functions",
    "variablesInSubtitle": "Variables",
    "typeAliasesInSubtitle": "Type Aliases",
    "membersInSubtitle": "Members",
    "improveThisDoc": "Edit this page",
    "viewSource": "View Source",
    "inheritance": "Inheritance",
    "derived": "Derived",
    "inheritedMembers": "Inherited Members",
    "package": "Package",
    "namespace": "Namespace",
    "assembly": "Assembly",
    "syntax": "Syntax",
    "overrides": "Overrides",
    "implements": "Implements",
    "remarks": "Remarks",
    "examples": "Examples",
    "seealso": "See Also",
    "declaration": "Declaration",
    "parameters": "Parameters",
    "typeParameters": "Type Parameters",
    "type": "Type",
    "name": "Name",
    "description": "Description",
    "returns": "Returns",
    "fieldValue": "Field Value",
    "propertyValue": "Property Value",
    "eventType": "Event Type",
    "variableValue": "Variable Value",
    "typeAliasType": "Type Alias Type",
    "exceptions": "Exceptions",
    "condition": "Condition",
    "extensionMethods": "Extension Methods",
    "note": "Note",
    "warning": "Warning",
    "tip": "Tip",
    "important": "Important",
    "caution": "Caution",
    "tocToggleButton": "Show / Hide Table of Contents",
    "tocFilter": "Filter by title",
    "search": "Search",
    "searchResults": "Search Results for",
    "searchResultsCount": "{count} results for \"{query}\"",
    "searchNoResults": "No results for \"{query}\"",
    "pageFirst": "First",
    "pagePrev": "Previous",
    "pageNext": "Next",
    "pageLast": "Last",
    "inThisArticle": "In this article",
    "nextArticle": "Next",
    "prevArticle": "Previous",
    "backToTop": "Back to top",
    "themeLight": "Light",
    "themeDark": "Dark",
    "themeAuto": "Auto",
    "changeTheme": "Change theme",
    "copy": "Copy",
    "downloadPdf": "Download PDF",
    "_shared": {}
  },
  "_disableToc": false,
  "docurl": "https://github.com/ezEngine/docs-src/blob/main/pages/docs/runtime/world/world-modules.md/#L1"
}