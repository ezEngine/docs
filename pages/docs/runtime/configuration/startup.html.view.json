{
  "conceptual": "\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"3\">Initializing an engine and shutting it properly down again, is a surprisingly difficult task. There are many steps involved, some of which have hard requirements on their ordering. Also, some functionality can only be initialized when at least a window, and potentially even a graphics API is available, which is not the case for command line tools. Once <a href=\"~/pages/docs/custom-code/cpp/engine-plugins.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"3\">plugins</a> are added to the mix, which can be loaded and unloaded at any time, it becomes impossible to manually set up this process.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"5\">Therefore, EZ uses a dedicated <em sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"5\">startup system</em>, to handle this complexity automatically for you.</p>\n<h2 id=\"startup-system-concept\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"7\">Startup System Concept</h2>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"9\">The concept of the startup system is simple. For every 'thing' in the engine you write code how to initialize it and shut it down again. 'Things' in the startup system are referred to as <strong sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"9\">subsystems</strong>. You then define what other subsystems you depend on, so that your startup code should run after your dependencies, and your shutdown code should run before your dependencies.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"11\">All of this is then (automatically) given to the startup system, and when it comes time to fully boot up the engine, that system sorts all subsystems by their dependencies and executes them in the right order. Conversely, it executes all shutdown code in the reverse order.</p>\n<h3 id=\"two-phase-startup\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"13\">Two Phase Startup</h3>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"15\">A lot of code can be initialized easily in all applications. However, some code strictly requires a window or graphics API to work with and could never be initialized successfully in a command line application.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"17\">Therefore, the startup system splits the engine initialization into two phases: <strong sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"17\">core systems startup</strong> (phase 1) and <strong sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"17\">high level systems startup</strong> (phase 2).\nFor command line applications, we would only ever run phase 1. In a proper game, we would first run phase 1, then create our window and rendering API and finally run phase 2. This way, when we don't need things like a renderer or the <a href=\"~/pages/docs/input/input-overview.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"18\">input system</a>, we simply exclude all high level systems from being initialized.</p>\n<h3 id=\"dependencies\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"20\">Dependencies</h3>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"22\">Some subsystems depend on other subsystems to be initialized. Therefore the startup system requires you to provide a <em sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"22\">name</em> for every subsystem and also a <em sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"22\">group</em>. The name can be arbitrary but has to be unique. The group name obviously does not need to be unique, as multiple subsystems can be part of the same group.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"24\">When you declare a dependency on another subsystem, you can then either specify it by its direct name, or you can also just declare a dependency on an entire group. The latter is very common, as it is often easier, and you rarely have very strict dependencies on a single subsystem.</p>\n<h2 id=\"startup-system-usage\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"26\">Startup System Usage</h2>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"28\">In practice, to use the startup system, you need to add a block of code to some cpp file. You can copy this code from <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"28\">Foundation/Configuration/Startup.h</code> and then just fill out the parts that you require. An example is given in the <a href=\"~/pages/samples/sample-game-plugin.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"28\">Sample Game Plugin</a>:</p>\n<!-- BEGIN-DOCS-CODE-SNIPPET: startup-block -->\n<pre><code class=\"lang-cpp\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"31\">// clang-format off\nEZ_BEGIN_SUBSYSTEM_DECLARATION(SampleGamePluginStartupGroup, SampleGamePluginMainStartup)\n\n  // list all the subsystems that we want to be initialized first\n  BEGIN_SUBSYSTEM_DEPENDENCIES\n    &quot;Foundation&quot;, // all subsystems from the 'Foundation' group (this is redundant, because `Core` already depends on `Foundation`)\n    &quot;Core&quot;        // and all subsystems from the 'Core' group\n  END_SUBSYSTEM_DEPENDENCIES\n\n  ON_CORESYSTEMS_STARTUP\n  {\n    // allocate an implementation of PrintInterface\n    s_PrintInterface = EZ_DEFAULT_NEW(PrintImplementation);\n\n    s_PrintInterface-&gt;OnCoreSystemsStartup();\n    s_PrintInterface-&gt;Print(&quot;Called ON_CORESYSTEMS_STARTUP&quot;);\n  }\n\n  ON_CORESYSTEMS_SHUTDOWN\n  {\n    s_PrintInterface-&gt;Print(&quot;Called ON_CORESYSTEMS_SHUTDOWN&quot;);\n\n    // clean up the s_PrintInterface, otherwise we would get asserts about memory leaks at shutdown\n    s_PrintInterface.Clear();\n  }\n\n  ON_HIGHLEVELSYSTEMS_STARTUP\n  {\n    // we can query 'an implementation of PrintInterface' through the ezSingletonRegistry\n    ezSingletonRegistry::GetSingletonInstance&lt;PrintInterface&gt;()-&gt;Print(&quot;Called ON_HIGHLEVELSYSTEMS_STARTUP&quot;);\n  }\n\n  ON_HIGHLEVELSYSTEMS_SHUTDOWN\n  {\n    // we could also query 'the one instance of the PrintImplementation singleton'\n    PrintImplementation::GetSingleton()-&gt;Print(&quot;Called ON_HIGHLEVELSYSTEMS_SHUTDOWN&quot;);\n  }\n\nEZ_END_SUBSYSTEM_DECLARATION;\n</code></pre>\n<!-- END-DOCS-CODE-SNIPPET -->\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"74\">Here we give our subsystem the name <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"74\">SampleGamePluginMainStartup</code> and we put it into the group <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"74\">SampleGamePluginStartupGroup</code>. Both names could be used by other subsystems to reference this as a dependency. We then specify that this subsystem should be initialized only after all the <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"74\">Foundation</code> and <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"74\">Core</code> subsystems have been booted. Both groups contain many subsystems, but we don't need to care about those details.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"76\">Now when the application starts running, at some point it will run all the <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"76\">ON_CORESYSTEMS_STARTUP</code> code blocks (in a sorted order). Here, we use that hook to set up our <a href=\"~/pages/docs/runtime/configuration/interfaces.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"76\">singleton</a>. Later, the game will execute the <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"76\">ON_HIGHLEVELSYSTEMS_STARTUP</code> block, and at shutdown it will first execute <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"76\">ON_HIGHLEVELSYSTEMS_SHUTDOWN</code> and finally <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"76\">ON_CORESYSTEMS_SHUTDOWN</code> shortly before the application closes.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"78\">Command line applications would not execute the high level startup code blocks. Also, when a <a href=\"~/pages/docs/custom-code/cpp/engine-plugins.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"78\">plugin</a> is loaded or unloaded, the system ensures to call all the right startup and shutdown functions for subsystems from those plugins.</p>\n<h2 id=\"how-to-know-about-dependencies\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"80\">How to know about dependencies</h2>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"82\">A practical problem you may be wondering about, is how you would know the names of potential subsystem dependencies, or how you would even know what subsystems exist.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"84\">In practice, this is rarely a problem. Most subsystems only depend on the <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"84\">Foundation</code> or the <code sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"84\">Core</code> group of subsystems. If you have any other dependencies, you are typically quite aware of them, and know where in the code they are set up and thus, where you can look up their names.</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"86\">However, you can also use <a href=\"~/pages/docs/tools/inspector.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"86\">ezInspector</a> to discover all the available subsystems, their names, and see what other subsystems they depend on:</p>\n<p sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"88\"><img src=\"~/pages/docs/runtime/configuration/media/inspector-subsystems.png\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"88\" alt=\"Subsystems\"></p>\n<h2 id=\"see-also\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"90\">See Also</h2>\n<ul sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"93\">\n<li sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"93\"><a href=\"~/pages/docs/tools/inspector.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"93\">ezInspector</a></li>\n<li sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"94\"><a href=\"~/pages/docs/runtime/configuration/interfaces.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"94\">Singleton Interfaces</a></li>\n<li sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"95\"><a href=\"~/pages/samples/sample-game-plugin.md\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"95\">Sample Game Plugin</a></li>\n</ul>\n",
  "type": "Conceptual",
  "source": {
    "remote": {
      "path": "pages/docs/runtime/configuration/startup.md",
      "branch": "main",
      "repo": "https://github.com/ezEngine/docs-src"
    },
    "startLine": 0,
    "endLine": 0
  },
  "path": "pages/docs/runtime/configuration/startup.md",
  "documentation": {
    "remote": {
      "path": "pages/docs/runtime/configuration/startup.md",
      "branch": "main",
      "repo": "https://github.com/ezEngine/docs-src"
    },
    "startLine": 0,
    "endLine": 0
  },
  "_appFaviconPath": "assets/images/favicon.svg",
  "_appFooter": "Hello",
  "_appLogoPath": "assets/images/EZ-text.svg",
  "_appName": "ezEngine",
  "_appTitle": "ezEngine",
  "_enableGoogleAnalytics": true,
  "_enableNewTab": true,
  "_enableSearch": true,
  "_gitContribute": {
    "repo": "https://github.com/ezEngine/docs-src",
    "branch": "main"
  },
  "_systemKeys": [
    "conceptual",
    "type",
    "source",
    "path",
    "documentation",
    "title",
    "rawTitle",
    "wordCount"
  ],
  "rawTitle": "<h1 id=\"startup-system\" sourcefile=\"pages/docs/runtime/configuration/startup.md\" sourcestartlinenumber=\"1\">Startup System</h1>",
  "title": "Startup System",
  "wordCount": 870,
  "_key": "pages/docs/runtime/configuration/startup.md",
  "_navKey": "~/toc.yml",
  "_navPath": "toc.html",
  "_navRel": "../../../../toc.html",
  "_path": "pages/docs/runtime/configuration/startup.html",
  "_rel": "../../../../",
  "_tocKey": "~/pages/docs/toc.md",
  "_tocPath": "pages/docs/toc.html",
  "_tocRel": "../../toc.html",
  "__global": {
    "namespacesInSubtitle": "Namespaces",
    "classesInSubtitle": "Classes",
    "structsInSubtitle": "Structs",
    "interfacesInSubtitle": "Interfaces",
    "enumsInSubtitle": "Enums",
    "delegatesInSubtitle": "Delegates",
    "constructorsInSubtitle": "Constructors",
    "fieldsInSubtitle": "Fields",
    "propertiesInSubtitle": "Properties",
    "methodsInSubtitle": "Methods",
    "eventsInSubtitle": "Events",
    "operatorsInSubtitle": "Operators",
    "eiisInSubtitle": "Explicit Interface Implementations",
    "functionsInSubtitle": "Functions",
    "variablesInSubtitle": "Variables",
    "typeAliasesInSubtitle": "Type Aliases",
    "membersInSubtitle": "Members",
    "improveThisDoc": "Edit this page",
    "viewSource": "View Source",
    "inheritance": "Inheritance",
    "derived": "Derived",
    "inheritedMembers": "Inherited Members",
    "package": "Package",
    "namespace": "Namespace",
    "assembly": "Assembly",
    "syntax": "Syntax",
    "overrides": "Overrides",
    "implements": "Implements",
    "remarks": "Remarks",
    "examples": "Examples",
    "seealso": "See Also",
    "declaration": "Declaration",
    "parameters": "Parameters",
    "typeParameters": "Type Parameters",
    "type": "Type",
    "name": "Name",
    "description": "Description",
    "returns": "Returns",
    "fieldValue": "Field Value",
    "propertyValue": "Property Value",
    "eventType": "Event Type",
    "variableValue": "Variable Value",
    "typeAliasType": "Type Alias Type",
    "exceptions": "Exceptions",
    "condition": "Condition",
    "extensionMethods": "Extension Methods",
    "note": "Note",
    "warning": "Warning",
    "tip": "Tip",
    "important": "Important",
    "caution": "Caution",
    "tocToggleButton": "Show / Hide Table of Contents",
    "tocFilter": "Filter by title",
    "search": "Search",
    "searchResults": "Search Results for",
    "searchResultsCount": "{count} results for \"{query}\"",
    "searchNoResults": "No results for \"{query}\"",
    "pageFirst": "First",
    "pagePrev": "Previous",
    "pageNext": "Next",
    "pageLast": "Last",
    "inThisArticle": "In this article",
    "nextArticle": "Next",
    "prevArticle": "Previous",
    "backToTop": "Back to top",
    "themeLight": "Light",
    "themeDark": "Dark",
    "themeAuto": "Auto",
    "changeTheme": "Change theme",
    "copy": "Copy",
    "downloadPdf": "Download PDF",
    "_shared": {}
  },
  "_disableToc": false,
  "docurl": "https://github.com/ezEngine/docs-src/blob/main/pages/docs/runtime/configuration/startup.md/#L1"
}